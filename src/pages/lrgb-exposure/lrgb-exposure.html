<h4>LRGB Exposure</h4>
<div class="row pt-3">
  <div class="col-md-12">
    <div class="card bg-light border-secondary">
      <div class="card-body">
        <h5 class="card-title">What does it do?</h5>
        <p class="card-text">
          It helps you create full color images using your monochrome camera and filters.
          You begin by specifying the desired integration time of the luminance filter.
          In response it calculates the integration time of each color filter so as to balance the
          signal-to-noise. Optionally, you can select the amount of hardware
          binning, and the color balance ratios for your particular camera and filters.
        </p>
      </div>
    </div>
  </div>
</div>
<div class="row pt-3 pb-4">
  <div class="col-md-12">
    Do you want to enter the RGB exposure values yourself? (see Notes below)
  </div>
  <div class="col-md-12">
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="variable" data-bind="checked: frameCountMode">
      <label class="form-check-label" for="inlineRadio1">Yes</label>
    </div>
    <div class="form-check form-check-inline">
      <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="common" data-bind="checked: frameCountMode">
      <label class="form-check-label" for="inlineRadio2">No</label>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <table class="table table-secondary table-sm">
      <thead>
        <tr class="table-light">
          <th scope="col">Filter</th>
          <th scope="col">Binning</th>
          <th scope="col">Color Balance</th>
          <th scope="col">Frame Count</th>
          <th scope="col">Exposure&nbsp;(s)</th>
          <th scope="col">Integration&nbsp;(m)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticLuminance1" data-bind="value: lblLuminance">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticLuminance1" data-bind="value: lblLuminanceBinning">
          </td>
          <td></td>
          <td>
            <input type="text" class="form-control" id="formLuminanceFrameCount" data-bind="value: luminanceFrameCount, valueUpdate: 'input'">
          </td>
          <td>
            <input type="text" class="form-control" id="formLuminanceExposure" data-bind="value: luminanceExposure, valueUpdate: 'input'">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticIntegrationTimeL" data-bind="value: luminanceIntegrationTime">
          </td>
        </tr>
        <tr>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticRed1" data-bind="value: lblRed">
          </td>
          <td>
            <select class="form-control" id="formRedBinning" data-bind="value: rgbBinning">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
            </select>
          </td>
          <td>
            <input type="text" class="form-control" id="formRedColorBalance" data-bind="value: redBalance, valueUpdate: 'input'">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticRedFrameCount" data-bind="value: redFrameCount">
          </td>
          <td>
            <input type="text" class="form-control" id="formRedExposure" data-bind="value: redExposure, valueUpdate: 'input', attr: { readonly: modeStatus }">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticIntegrationTimeR" data-bind="value: redIntegrationTime">
          </td>
        </tr>
        <tr>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticGreen1" data-bind="value: lblGreen">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticGreenBinning" data-bind="value: rgbBinning">
          </td>
          <td>
            <input type="text" class="form-control" id="formGreenColorBalance" data-bind="value: greenBalance, valueUpdate: 'input'">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticGreenFrameCount" data-bind="value: greenFrameCount">
          </td>
          <td>
            <input type="text" class="form-control" id="formGreenExposure" data-bind="value: greenExposure, valueUpdate: 'input', attr: { readonly: modeStatus }">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticIntegrationTimeG" data-bind="value: greenIntegrationTime">
          </td>
        </tr>
        <tr>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticBlue1" data-bind="value: lblBlue">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticBlueBinning" data-bind="value: rgbBinning">
          </td>
          <td>
            <input type="text" class="form-control" id="formBlueColorBalance" data-bind="value: blueBalance, valueUpdate: 'input'">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticBlueFrameCount" data-bind="value: blueFrameCount">
          </td>
          <td>
            <input type="text" class="form-control" id="formBlueExposure" data-bind="value: blueExposure, valueUpdate: 'input', attr: { readonly: modeStatus }">
          </td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticIntegrationTimeB" data-bind="value: blueIntegrationTime">
          </td>
        </tr>
        <tr class="table-light">
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td>
            <input type="text" readonly class="form-control-plaintext" id="staticIntegrationTimeT" data-bind="value: totalIntegrationTime">
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<div class="row pt-3">
  <div class="col-md-12">
    <div class="card bg-light border-secondary">
      <div class="card-body">
        <h5 class="card-title">Motivation</h5>
        <p class="card-text">
          Newcomers to color imaging who have monochrome cameras struggle to find the right combination of exposure times
          to achieve acceptable results. By acceptable results I mean those that lend itself easily to post-processing.
          If you find that you have to employ extreme measures in post-processing software then this calculator will help. Credit goes to
          Starizona for their article on <a href="https://starizona.com/tutorial/color-imaging-3/" target="_blank">Color Imaging</a> which
          provided inspiration.
        </p>
      </div>
    </div>
  </div>
</div>
<div class="row pt-3">
  <div class="col-md-12">
    <div class="card bg-light border-secondary">
      <div class="card-body">
        <h5 class="card-title">Theory of Operation</h5>
        <p class="card-text">
          Visible light covers the spectrum of wavelengths from 400nm to 700nm that spans blue to red, respectively.
          These wavelengths are passed by the Luminance filter which when you hold it up to light appears clear but
          in fact blocks infrared and ultraviolet that can spoil an image. The Red filter passes light between 600nm
          and 700nm, Green between 500nm and 600nm, and Blue between 400nm and 500nm.
        </p>
        <p class="card-text">
          So-called <em>white light</em> emits all wavelengths in equal amounts. Our Sun is said to be the benchmark white
          light source. Its spectral type is G2V. Year-round there are many G2V stars in the night sky that you can
          use to <em>color balance</em> your filters and camera. That is the subject of another calculator that I will link
          to when ready.
        </p>
        <p class="card-text">
          Common exposures using the luminance filter are almost always shorter than color filters unless you use a
          feature called <em>binning</em> (more on that later).
        </p>
        <p class="card-text">
          Let's try an experiment with the calculator:
        </p>
        <ol>
          <li>Set <em>Binning</em> to 1</li>
          <li>Ensure that <em>Color Balance</em> is 1:1:1 for RGB</li>
          <li>It doesn't matter what <em>Frame Count</em> is</li>
        </ol>
        <p class="card-text">
          Notice that the RGB exposure values are three times longer than Luminance. That's because the luminance filter
          passes three times more photons.
        </p>
        <p class="card-text">
          Let's talk about binning. Binning refers to a feature of the camera that increases the signal-to-noise ratio
          (SNR) of a frame. We haven't talked at all about noise but know that it is ever-present. Low noise images are
          our goal.
        </p>
        <p class="card-text">
          One negative side-effect of binning is that it reduces image resolution. bin2 means that the dimensions of a
          frame are half the normal size. The camera achieves this by taking each 2x2 matrix of pixels and reducing it
          to 1 pixel. bin3 takes a 3x3 matrix.
        </p>
        <p class="card-text">
          This isn't as terrible as it sounds. I think it was Trevor Jones at
          <a href="https://astrobackyard.com/" target="_blank">AstroBackyard</a> who made the analogy of a
          child and his coloring book. The child provides the crayons and the publisher provides the detail in the form
          of the outline. If the child draws a little outside the outline the picture still looks good. If he gets sloppy
          it gets worse but is still acceptable especially if seen from a distance. This is the analogy that Trevor made
          with binning: bin2 is like the child drawing a little outside the outline, and bin3 is sloppy but acceptable.
          Remember that the <em>outline</em> is the job of the luminance filter running at bin1 and since the sensor sees three
          times more photons the exposure time is reasonably short.
        </p>
        <p class="card-text">
          Let's try another experiment with the calculator:
        </p>
        <ol>
          <li>Set <em>Binning</em> to 2</li>
          <li>Ensure that <em>Color Balance</em> is 1:1:1 for RGB</li>
          <li>It doesn't matter what <em>Frame Count</em> is</li>
        </ol>
        <p class="card-text">
          Now notice that the RGB exposure values are less than the Luminance and that the total time to capture a full
          LRGB sequence is about one-third!
        </p>
        <p class="card-text">
          Before purchasing an imaging camera please check the manufacturer's website to ensure that it offers bin2,
          at least. Even better if it offers bin3.
        </p>
      </div>
    </div>
  </div>
</div>
<div class="row pt-3">
  <div class="col-md-12">
    <div class="card bg-light border-secondary">
      <div class="card-body">
        <h5 class="card-title">Notes</h5>
        <p class="card-text">
          <em>&quot;Do you want to enter the RGB exposure values yourself?&quot;</em>
        </p>
        <p class="card-text">
          If you accept the default answer "No" then depending on your color balance ratios the calculator will recommend
          three different exposures: one for red, green, and blue. On the other hand if you answer "Yes" then you have the
          opportunity to reduce the number of exposures to perhaps as low as one which has benefits for when you capture
          calibration dark frames but be careful if your color balance ratios are significantly spread apart.
        </p>
        <p class="card-text">
          My color balance ratios are 1.71 : 1.00 : 1.55. For a 120-second luminance exposure the calculator by default
          recommends 114.4s for reds, 66.9s for greens, and 103.7s for blues. If I choose one exposure, say 90s, then green
          frames will be overexposed and red frames will be underexposed which is something you want to avoid. In my case
          I would choose two exposure values: 110s for reds and blues, and 70s for greens. Now at least I would reduce three
          sets of darks to two sets which is still a significant savings.
        </p>
        <p class="card-text">
          Your color balance ratios will be different. If you determine that your ratios are in a fairly tight
          range, say from 1.0 to 1.2, then you can choose one exposure value.
        </p>
      </div>
    </div>
  </div>
</div>
<div class="card bg-light border-secondary mt-3">
  <div class="row no-gutters">
    <div class="col-md-4">
      <img src="images/M31-120s_comparison_RGB-different.png" class="card-img" alt="M31 Sample Images">
    </div>
    <div class="col-md-8">
      <div class="card-body">
        <h5 class="card-title">The advantage of using a different exposure for each filter</h5>
        <p class="card-text">
          Having good quality data makes image processing almost effortless. For the following images
          it was simple: a small stretch, a little contrast adjustment, and some sharpening. No
          background or star color calibration needed.
          Please note that using exposure values to a fraction of a second is a bit anal retentive on
          my part. Feel free to round it to the nearest whole number: 114s, 67s, 104s.
        </p>
        <p class="card-text">
          Bottom image (Fig. C) - Lum:38x120s
          <span class="text-danger">Red:13x114.4s</span>
          <span class="text-success">Green:13x66.9s</span>
          <span class="text-info">Blue:13x103.7s</span>
        </p>
        <p class="card-text">
          Top image (Fig. D) - Lum:38x120s
          <span class="text-danger">Red:20x114.4s</span>
          <span class="text-success">Green:20x66.9s</span>
          <span class="text-info">Blue:20x103.7s</span> -
          I increased the size of the color stacks to see the effect: richer colors and lower noise.
        </p>
      </div>
    </div>
  </div>
</div>
<div class="card bg-light border-secondary mt-3">
  <div class="row no-gutters">
    <div class="col-md-4">
      <img src="images/M31-L38x120s-R18x90s-G6x90s-B15x90s-bmorgan-20190925-APP.png" class="card-img" alt="M31 Sample Images">
    </div>
    <div class="col-md-8">
      <div class="card-body">
        <h5 class="card-title">Potential problems with using a single RGB exposure</h5>
        <p class="card-text">
          As discussed in the Notes section you should be wary of using a single RGB exposure
          value when your color balance ratios are significantly spread apart. The accompanying
          image used a 90s exposure for red, green, and blue. As a result the green frames were
          overexposed by 35&percnt; over the recommended value, and the red and blue frames were
          underexposed by 20&percnt;.
        </p>
        <p class="card-text">
          Image - Lum:38x120s <span class="text-danger">Red:18x90s</span>
          <span class="text-success">Green:6x90s</span>
          <span class="text-info">Blue:15x90s</span> - The calculator recommended
          to stack only 6 green frames to compensate for overexposure. Although the image is
          passable in terms of quality it still has a green cast. Seen on its own it is not bad
          but when compared to a properly exposed image seen in the previous panel it shows its
          deficiencies. An effort was made to calibrate the background and star color using
          APP but the image simply took on a magenta cast.
        </p>
        <p class="card-text">
          In the Notes section I talk about the possibility of using two exposures instead of
          three. I'll work on acquiring that data for comparison.
        </p>
      </div>
    </div>
  </div>
</div>
<div class="row pt-3">
  <div class="col-md-12">
    <div class="card bg-light border-secondary">
      <div class="card-body">
        <h5 class="card-title">Disclaimer</h5>
        <p class="card-text">
          This calculator will get you in the <em>ballpark</em>. Notice that it doesn't talk about your particular seeing
          conditions: urban skies versus rural. You probably noticed that RGB exposures are a function of the luminance
          exposure but what luminance exposure should you use? That will depend on your seeing conditions. If you are in
          a city then you need short exposures. If you are rural then long exposures make sense.
        </p>
        <p class="card-text">
          It comes with practice but you need to find a happy medium between capturing the Deep Sky object and reducing
          star saturation. Remember that stars make up your composition too. For me, with my Bortle 5 suburban skies, I
          generally use 120-second luminance exposures. When I travel to a Bortle 4 site I increase it to 240 seconds.
        </p>
        <p class="card-text">
          Generally speaking, longer exposures will produce less noisy images but it puts a strain on your mount's ability
          to track the target without smearing it. Also, longer exposures mean a higher likelihood that frames will be
          spoiled by aircraft, satellites, and passing clouds. As always - experiment! Don't go for the <em>brass ring</em>
          the first time out. Start small and build from there as your knowledge increases.
        </p>
      </div>
    </div>
  </div>
</div>
